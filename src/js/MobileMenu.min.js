(function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.MobileMenu=a()})(function(){return MobileMenu=function(){return function(a,b){var c=this,d=function(a,b){for(var c in a)void 0===b[c]?b[c]=a[c]:"object"==typeof b[c]&&d(a[c],b[c])};return c.options=b||{},c.selector=a,c.defaults={menuClass:"active",overlayClass:"active",openButtonClass:"active",fakeScrollbarClass:"active",bodyClass:"no-scroll",allowPageScroll:!1,overlayClick:!0,escToClose:!0,toRight:!1,toLeft:!1,fixHeader:"",fixHeaderClass:"fixed",fixHeaderThreshold:0,fade:!1,swipe:!0,swipeThreshold:.3,fakeScrollbar:"#fake-scrollbar"},c.$menu=null,c.$openButton=null,c.$closeButtons=null,c.$overlay=null,c.$fakeScrollbar=null,c.$header=null,c.$headerClone=null,c.$headerParent=null,c.menuWidth=0,c.menuHeight=0,c.opened=!1,c.trfRegExp=/([-0-9.]+(?=px))/,c.trf={property:"transform",from:"",to:"translate3d(0px, 0px, 0px)",timigFunction:"ease",delay:0,duration:.5},c.fade={property:"opacity",from:"0",to:"1",timigFunction:"ease",delay:0,duration:.5},c.swipeObject={isSwipe:!1,isScroll:!1,posX1:0,posX2:0,posY1:0,posY2:0,posInitX:0,posInitY:0},c.openMenuHandler={handleEvent:c.openMenu,ctx:c},c.closeMenuHandler={handleEvent:c.closeMenu,ctx:c},c.transitionHandler={handleEvent:c.transitionEnd,ctx:c},c.swipeStartHandler={handleEvent:c.swipeStart,ctx:c},c.swipeActionHandler={handleEvent:c.swipeAction,ctx:c},c.swipeEndHandler={handleEvent:c.swipeEnd,ctx:c},c.fixHeaderHandler={handleEvent:c.fixHeader,ctx:c},c.unfixHeaderHandler={handleEvent:c.unfixHeader,ctx:c},d(c.defaults,c.options),c.init(),c.$menu}}(),MobileMenu.prototype.init=function(){var a,b=this,c=b.options,d=c.openButton,e=c.closeButtons,f=c.overlay,g=c.fixHeader;b.q=function(a,b){return b=b||document.body,b.querySelector(a)},b.$menu=b.q(b.selector),d&&(b.$openButton=b.q(d)),e&&(b.$closeButtons=document.querySelectorAll(e)),f&&(b.$overlay=b.q(f)),c.allowPageScroll||(b.$fakeScrollbar=b.q(c.fakeScrollbar)),g&&(b.$fixHeader=b.q(g));var h=b.$menu;if(f=b.$overlay,g=b.$fixHeader,c.fade)a=b.fade,c.swipe=!1;else{c.toRight||c.toLeft||(c.toLeft=!0);var i=c.toRight?"-100%":c.toLeft?"100%":"0px";b.trf.from="translate3d("+i+", 0px, 0px)",a=b.trf}f&&(f.style.cssText="transition:opacity .5s;opacity:0"),h.style.cssText="transition:"+a.property+" "+a.duration+"s "+a.delay+"s "+a.timigFunction+";"+a.property+":"+a.from,"none"===h.style.display&&(h.style.display=""),g&&(b.$headerClone=g.cloneNode(!0),b.$headerParent=g.parentElement,b.options.fixHeaderThreshold=g.getBoundingClientRect().bottom+pageYOffset,b.$headerClone.style.opacity=0,b.$headerClone.style.pointerEvents="none",b.fixHeader()),b.initEvents(),b.$menu.openMenu=b.openMenu,b.$menu.closeMenu=b.closeMenu,b.$menu.ctx=b,b.dispatchEvent(h,"menuinit")},MobileMenu.prototype.initEvents=function(){var a=this,b=a.options,c=a.$menu,d=a.$openButton,e=a.$closeButtons,f=a.$overlay,g=!!Array.of&&{passive:!0};d.addEventListener("click",a.openMenuHandler);for(var h=0;h<e.length;h++)e[h].addEventListener("click",a.closeMenuHandler);c.addEventListener("transitionend",a.transitionHandler),b.swipe&&!b.fade&&c.addEventListener("touchstart",a.swipeStartHandler,g),b.escToClose&&document.addEventListener("keyup",a.closeMenuHandler),f&&b.overlayClick&&f.addEventListener("click",a.closeMenuHandler),a.$fixHeader&&window.addEventListener("scroll",a.fixHeaderHandler,g)},MobileMenu.prototype.openMenu=function(a){var b,c=this.ctx||this,d=c.options,e=c.$menu,f=c.$openButton,g=c.$closeButton,h=c.$overlay,i=c.$fakeScrollbar,j=document.body;c.opened||(!0!==a&&c.dispatchEvent(e,"menubeforeopen"),event&&"click"===event.type&&(c.$caller=e.caller=event.target),h&&h.classList.add(d.overlayClass),f.classList.add(d.openButtonClass),e.classList.add(d.menuClass),i&&(i.classList.add(d.fakeScrollbarClass),j.classList.add(d.bodyClass),j.style.paddingRight=i.offsetWidth-i.clientWidth+"px"),c.menuWidth=e.offsetWidth,c.menuHeight=e.offsetHeight,!0!==a&&(e.scrollTop=0),b=d.fade?c.fade:c.trf,e.style.cssText="transition:"+b.property+" "+b.duration+"s "+b.delay+"s "+b.timigFunction+";"+b.property+":"+b.to,h&&(h.style.opacity=1))},MobileMenu.prototype.closeMenu=function(a){if(!(event&&"keyup"===event.type&&27!==event.keyCode)){var b,c=this.ctx||this,d=c.options,e=c.$menu,f=c.$openButton,g=c.$closeButton,h=c.$overlay;c.opened&&(!a&&c.dispatchEvent(e,"menubeforeclose"),f.classList.remove(d.openButtonClass),b=d.fade?c.fade:c.trf,e.style.cssText="transition:"+b.property+" "+b.duration+"s "+b.delay+"s "+b.timigFunction+";"+b.property+":"+b.from,h&&(h.style.opacity=0))}},MobileMenu.prototype.swipeStart=function(){var a=this.ctx||this,b=a.options,c=a.$menu,d=a.swipeObject,e=event.touches[0]||window.event.touches[0];d.isSwipe=d.isScroll=!1,d.posInitX=d.posX1=e.clientX,d.posInitY=d.posY1=e.clientY,c.addEventListener("touchend",a.swipeEndHandler),c.addEventListener("touchmove",a.swipeActionHandler),c.style.transition=""},MobileMenu.prototype.swipeAction=function(){var a=this.ctx||this,b=a.options,c=a.$menu,d=a.swipeObject,e=event.touches[0]||window.event.touches[0],f=c.style.transform,g=+f.match(a.trfRegExp)[0];if(d.posX2=d.posX1-e.clientX,d.posX1=e.clientX,d.posY2=d.posY1-e.clientY,d.posY1=e.clientY,!d.isSwipe&&!d.isScroll){var h=Math.abs(d.posY2),i=Math.abs(d.posX2);7<h||0===d.posX2?d.isScroll=!0:7>h&&(d.isSwipe=!0)}if(d.isSwipe){if(b.toLeft&&d.posInitX>d.posX1)return void(c.style.transform=a.trf.to);if(b.toRight&&d.posInitX<d.posX1)return void(c.style.transform=a.trf.to);c.style.transform="translate3d("+(g-d.posX2)+"px, 0px, 0px)"}},MobileMenu.prototype.swipeEnd=function(){var a=this.ctx||this,b=a.options,c=a.$menu,d=a.swipeObject,e=a.trf;d.posFinal=d.posInitX-d.posX1;var f=Math.abs(d.posFinal);1<f&&d.isSwipe&&(b.toLeft&&0>d.posFinal||b.toRight&&0<d.posFinal)&&(f>=a.menuWidth*b.swipeThreshold?a.closeMenu(!0):(a.opened=!1,a.openMenu(!0))),c.removeEventListener("touchend",a.swipeEndHandler),c.removeEventListener("touchmove",a.swipeActionHandler)},MobileMenu.prototype.transitionEnd=function(){var a=this.ctx||this,b=a.options,c=a.$menu,d=a.$openButton,e=a.$closeButton,f=a.$overlay;event.target!==c||(a.opened?(a.opened=!1,c.classList.remove(b.menuClass),f&&f.classList.remove(b.overlayClass),a.allowPageScroll(),a.dispatchEvent(c,"menuclose")):(a.opened=!0,a.dispatchEvent(c,"menuopen")))},MobileMenu.prototype.dispatchEvent=function(a,b){if("function"==typeof window.CustomEvent){var c=new CustomEvent(b);a.dispatchEvent(c)}},MobileMenu.prototype.allowPageScroll=function(){var a=this.ctx||this,b=a.options,c=a.$fakeScrollbar,d=document.body;c&&(d.style.paddingRight="",c.classList.remove(b.fakeScrollbarClass),d.classList.remove(b.bodyClass))},MobileMenu.prototype.fixHeader=function(){var a=this.ctx||this,b=a.options;a.opened||a.$fixHeader.classList.contains(b.fixHeaderClass)||!(pageYOffset>b.fixHeaderThreshold)||(a.$headerParent.appendChild(a.$headerParent.replaceChild(a.$headerClone,a.$fixHeader)),a.$fixHeader.classList.add(b.fixHeaderClass),window.removeEventListener("scroll",a.fixHeaderHandler),window.addEventListener("scroll",a.unfixHeaderHandler),a.dispatchEvent(a.$fixHeader,"headerfixed"))},MobileMenu.prototype.unfixHeader=function(){var a=this.ctx||this,b=a.options;a.$fixHeader.classList.contains(b.fixHeaderClass)&&pageYOffset<=b.fixHeaderThreshold&&(a.$headerParent.replaceChild(a.$fixHeader,a.$headerClone),a.$fixHeader.classList.remove(b.fixHeaderClass),window.removeEventListener("scroll",a.unfixHeaderHandler),window.addEventListener("scroll",a.fixHeaderHandler),a.dispatchEvent(a.$fixHeader,"headerunfixed"))},MobileMenu});